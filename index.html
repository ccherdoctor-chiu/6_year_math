<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å°å°æ•¸å­¸ç¶²é </title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Noto Sans TC', sans-serif;
        }
        .age-card {
            transition: all 0.4s ease;
        }
        .age-card:hover {
            transform: translateY(-15px) scale(1.08);
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
        }
        .coin-animation {
            animation: coinBounce 0.6s ease-in-out;
        }
        @keyframes coinBounce {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.2); }
        }
        .gradient-text {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        .floating {
            animation: floating 3s ease-in-out infinite;
        }
        @keyframes floating {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }
    </style>
</head>
<body class="bg-gradient-to-br from-purple-400 via-pink-500 to-red-500 min-h-screen">

    <div class="min-h-screen flex flex-col">
        <!-- Header with Coin System -->
        <header class="bg-white bg-opacity-20 backdrop-blur-lg p-4 sm:p-6">
            <div class="max-w-6xl mx-auto flex justify-between items-center">
                <div class="flex items-center space-x-4">
                    <div class="text-3xl sm:text-4xl floating">ğŸ“</div>
                    <h1 class="text-2xl sm:text-3xl font-bold text-white gradient-text">
                        å°å°æ•¸å­¸ç¶²é 
                    </h1>
                </div>
                <div class="flex items-center space-x-2 bg-yellow-400 bg-opacity-90 px-4 py-2 rounded-full shadow-lg">
                    <span class="text-2xl" id="coinIcon">ğŸª™</span>
                    <span class="font-bold text-yellow-800" id="coinCount">0</span>
                    <span class="text-yellow-700 text-sm">é‡‘å¹£</span>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <main class="flex-1 flex items-center justify-center p-4">
            <div class="w-full max-w-6xl mx-auto">
                <div class="bg-white bg-opacity-95 rounded-3xl shadow-2xl p-6 sm:p-12">
                    
                    <!-- Welcome Section -->
                    <div class="text-center mb-12">
                        <h2 class="text-3xl sm:text-4xl font-bold text-gray-800 mb-4">
                            ğŸŒŸ æ­¡è¿ä¾†åˆ°æ•¸å­¸ç‹åœ‹ ğŸŒŸ
                        </h2>
                        <p class="text-lg sm:text-xl text-gray-600 mb-6">
                            é¸æ“‡ä½ çš„å¹´é½¡ï¼Œé–‹å§‹æ•¸å­¸å†’éšªæ—…ç¨‹ï¼
                        </p>
                        <div class="bg-blue-50 border-l-4 border-blue-400 p-4 rounded-lg max-w-2xl mx-auto">
                            <p class="text-blue-700">
                                ğŸ’¡ å°æç¤ºï¼šæ¯ç­”å°ä¸€é¡Œå¯ç²å¾— <span class="font-bold">10 é‡‘å¹£</span>ï¼Œå®Œæˆæ•´å€‹æ¸¬é©—é‚„æœ‰é¡å¤–çå‹µå“¦ï¼
                            </p>
                        </div>
                    </div>

                    <!-- Age Selection Grid -->
                    <div class="grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-4 sm:gap-6">
                        <script>
                            const container = document.querySelector('.grid');
                            const ageGroups = [
                                { age: 6, name: 'å…­æ­²', emoji: 'ğŸ', colors: 'from-red-400 to-pink-500', desc: 'åŸºç¤èªæ•¸' },
                                { age: 7, name: 'ä¸ƒæ­²', emoji: 'ğŸŒˆ', colors: 'from-orange-400 to-red-500', desc: 'ç°¡å–®åŠ æ¸›' },
                                { age: 8, name: 'å…«æ­²', emoji: 'ğŸš€', colors: 'from-yellow-400 to-orange-500', desc: 'ä¹˜æ³•å…¥é–€' },
                                { age: 9, name: 'ä¹æ­²', emoji: 'â­', colors: 'from-green-400 to-blue-500', desc: 'é™¤æ³•å­¸ç¿’' },
                                { age: 10, name: 'åæ­²', emoji: 'ğŸ¯', colors: 'from-blue-400 to-purple-500', desc: 'å››å‰‡é‹ç®—' },
                                { age: 11, name: 'åä¸€æ­²', emoji: 'ğŸ¨', colors: 'from-purple-400 to-pink-500', desc: 'åˆ†æ•¸æ¦‚å¿µ' },
                                { age: 12, name: 'åäºŒæ­²', emoji: 'ğŸ†', colors: 'from-indigo-400 to-purple-600', desc: 'é€²éšé‹ç®—' }
                            ];

                            ageGroups.forEach(group => {
                                const available = group.age === 6; // ç›®å‰åªæœ‰6æ­²å¯ç”¨
                                const cardClass = available ? 'age-card cursor-pointer' : 'opacity-50 cursor-not-allowed';
                                const onclick = available ? `window.location.href='index_${group.age}_year.html'` : 'showComingSoon()';
                                
                                const cardHtml = `
                                    <div class="${cardClass} bg-gradient-to-br ${group.colors} text-white rounded-2xl p-4 sm:p-6 flex flex-col items-center justify-center shadow-lg" onclick="${onclick}">
                                        <div class="text-4xl sm:text-5xl mb-2">${group.emoji}</div>
                                        <div class="text-xl sm:text-2xl font-bold mb-1">${group.name}</div>
                                        <div class="text-sm sm:text-base opacity-90 text-center">${group.desc}</div>
                                        ${available ? '<div class="mt-2 text-xs bg-white bg-opacity-20 px-2 py-1 rounded-full">å¯é–‹å§‹</div>' : '<div class="mt-2 text-xs bg-gray-500 bg-opacity-50 px-2 py-1 rounded-full">å³å°‡æ¨å‡º</div>'}
                                    </div>
                                `;
                                container.innerHTML += cardHtml;
                            });
                        </script>
                    </div>

                    <!-- Statistics Section -->
                    <div class="mt-12 grid grid-cols-1 sm:grid-cols-3 gap-4">
                        <div class="bg-gradient-to-r from-blue-500 to-blue-600 text-white p-4 rounded-xl text-center">
                            <div class="text-2xl font-bold" id="totalQuizzes">0</div>
                            <div class="text-sm opacity-90">å®Œæˆæ¸¬é©—</div>
                        </div>
                        <div class="bg-gradient-to-r from-green-500 to-green-600 text-white p-4 rounded-xl text-center">
                            <div class="text-2xl font-bold" id="correctAnswers">0</div>
                            <div class="text-sm opacity-90">ç­”å°é¡Œç›®</div>
                        </div>
                        <div class="bg-gradient-to-r from-purple-500 to-purple-600 text-white p-4 rounded-xl text-center">
                            <div class="text-2xl font-bold" id="accuracy">0%</div>
                            <div class="text-sm opacity-90">æ­£ç¢ºç‡</div>
                        </div>
                    </div>

                </div>
            </div>
        </main>

        <!-- Footer -->
        <footer class="bg-white bg-opacity-20 backdrop-blur-lg p-4 text-center">
            <p class="text-white text-sm">
                ğŸ‰ æŒçºŒå­¸ç¿’ï¼Œæˆç‚ºæ•¸å­¸å°å¤©æ‰ï¼åŠ æ²¹ï¼ ğŸ‰
            </p>
        </footer>
    </div>

    <!-- Coming Soon Modal -->
    <div id="comingSoonModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
        <div class="bg-white rounded-2xl p-8 max-w-md mx-4 text-center">
            <div class="text-6xl mb-4">ğŸš§</div>
            <h3 class="text-2xl font-bold text-gray-800 mb-4">å³å°‡æ¨å‡º</h3>
            <p class="text-gray-600 mb-6">é€™å€‹å¹´é½¡æ®µçš„æ•¸å­¸é¡Œæ­£åœ¨æº–å‚™ä¸­ï¼Œæ•¬è«‹æœŸå¾…ï¼</p>
            <button onclick="hideComingSoon()" class="bg-blue-500 hover:bg-blue-600 text-white px-6 py-2 rounded-lg font-semibold">
                çŸ¥é“äº†
            </button>
        </div>
    </div>

    <script>
        // é‡‘å¹£ç³»çµ± (æ³¨æ„ï¼šæ­¤ç‚ºæ¼”ç¤ºç‰ˆæœ¬ï¼Œä½¿ç”¨è¨˜æ†¶é«”å„²å­˜ï¼Œé é¢é‡æ•´å¾Œæœƒé‡ç½®)
        // åœ¨å¯¦éš›æ‡‰ç”¨ä¸­ï¼Œå¯ä»¥ä½¿ç”¨ localStorage ä¾†æŒä¹…åŒ–å„²å­˜
        let gameData = {
            coins: 0,
            totalQuizzes: 0,
            correctAnswers: 0,
            totalQuestions: 0
        };

        // æ›´æ–°é¡¯ç¤º
        function updateDisplay() {
            document.getElementById('coinCount').textContent = gameData.coins;
            document.getElementById('totalQuizzes').textContent = gameData.totalQuizzes;
            document.getElementById('correctAnswers').textContent = gameData.correctAnswers;
            
            const accuracy = gameData.totalQuestions > 0 ? 
                Math.round((gameData.correctAnswers / gameData.totalQuestions) * 100) : 0;
            document.getElementById('accuracy').textContent = accuracy + '%';
        }

        // æ·»åŠ é‡‘å¹£ï¼ˆä¾›å¤–éƒ¨æ¸¬é©—é é¢èª¿ç”¨ï¼‰
        function addCoins(amount) {
            gameData.coins += amount;
            document.getElementById('coinIcon').classList.add('coin-animation');
            setTimeout(() => {
                document.getElementById('coinIcon').classList.remove('coin-animation');
            }, 600);
            updateDisplay();
        }

        // æ›´æ–°çµ±è¨ˆï¼ˆä¾›å¤–éƒ¨æ¸¬é©—é é¢èª¿ç”¨ï¼‰
        function updateStats(correct, total, quizCompleted = false) {
            gameData.correctAnswers += correct;
            gameData.totalQuestions += total;
            if (quizCompleted) {
                gameData.totalQuizzes += 1;
            }
            updateDisplay();
        }

        // é¡¯ç¤ºå³å°‡æ¨å‡ºå½ˆçª—
        function showComingSoon() {
            document.getElementById('comingSoonModal').classList.remove('hidden');
        }

        // éš±è—å³å°‡æ¨å‡ºå½ˆçª—
        function hideComingSoon() {
            document.getElementById('comingSoonModal').classList.add('hidden');
        }

        // å¾ localStorage è¼‰å…¥æ•¸æ“šï¼ˆæŒä¹…åŒ–å„²å­˜ï¼‰
        function loadGameData() {
            const saved = localStorage.getItem('mathGameData');
            if (saved) {
                gameData = JSON.parse(saved);
            }
        }

        // å„²å­˜æ•¸æ“šåˆ° localStorage
        function saveGameData() {
            localStorage.setItem('mathGameData', JSON.stringify(gameData));
        }

        // è¨ˆç®—é‡‘å¹£çå‹µ
        function calculateCoins(correct, total, quizCompleted = false) {
            let coins = 0;
            
            // æ¯ç­”å°ä¸€é¡Œï¼š10é‡‘å¹£
            coins += correct * 10;
            
            // å®Œæˆæ¸¬é©—çå‹µï¼š50é‡‘å¹£
            if (quizCompleted) {
                coins += 50;
            }
            
            // æ­£ç¢ºç‡çå‹µ
            const accuracy = total > 0 ? correct / total : 0;
            if (accuracy >= 0.9) {
                coins += 100; // 90%ä»¥ä¸Šï¼šé¡å¤–100é‡‘å¹£
            } else if (accuracy >= 0.8) {
                coins += 75;  // 80%ä»¥ä¸Šï¼šé¡å¤–75é‡‘å¹£
            } else if (accuracy >= 0.7) {
                coins += 50;  // 70%ä»¥ä¸Šï¼šé¡å¤–50é‡‘å¹£
            }
            
            return coins;
        }

        // é¡¯ç¤ºé‡‘å¹£ç²å¾—å‹•ç•«
        function showCoinReward(earnedCoins, quizName) {
            if (earnedCoins > 0) {
                // å‰µå»ºé‡‘å¹£ç²å¾—æç¤º
                const coinAlert = document.createElement('div');
                coinAlert.innerHTML = `
                    <div class="fixed top-4 right-4 bg-yellow-400 text-yellow-900 px-6 py-4 rounded-xl shadow-lg font-bold text-lg z-50 animate-bounce">
                        ğŸ‰ å®Œæˆ ${quizName}ï¼<br>
                        ç²å¾— ${earnedCoins} é‡‘å¹£ï¼ğŸª™
                    </div>
                `;
                document.body.appendChild(coinAlert);
                
                // 3ç§’å¾Œç§»é™¤æç¤º
                setTimeout(() => {
                    document.body.removeChild(coinAlert);
                }, 3000);
            }
        }

        // é é¢è¼‰å…¥æ™‚åˆå§‹åŒ–
        window.onload = function() {
            // è¼‰å…¥å„²å­˜çš„éŠæˆ²æ•¸æ“š
            loadGameData();
            
            // æª¢æŸ¥æ˜¯å¦å¾æ¸¬é©—é é¢è¿”å›
            const urlParams = new URLSearchParams(window.location.search);
            if (urlParams.has('quizResult')) {
                const result = JSON.parse(decodeURIComponent(urlParams.get('quizResult')));
                
                // è¨ˆç®—ç²å¾—çš„é‡‘å¹£
                const earnedCoins = calculateCoins(result.correct, result.total, true);
                
                // æ›´æ–°éŠæˆ²æ•¸æ“š
                gameData.coins += earnedCoins;
                gameData.correctAnswers += result.correct;
                gameData.totalQuestions += result.total;
                gameData.totalQuizzes += 1;
                
                // å„²å­˜æ›´æ–°å¾Œçš„æ•¸æ“š
                saveGameData();
                
                // é¡¯ç¤ºçå‹µæç¤º
                showCoinReward(earnedCoins, result.quizName);
                
                // æ¸…é™¤ URL åƒæ•¸ï¼ˆé¿å…é‡è¤‡è¨ˆç®—ï¼‰
                window.history.replaceState({}, document.title, window.location.pathname);
            }
            
            updateDisplay();
        };

        // å°‡é‡‘å¹£ç³»çµ±å‡½æ•¸ç¶å®šåˆ° window å°è±¡ï¼Œä¾›å…¶ä»–é é¢ä½¿ç”¨
        window.addCoins = addCoins;
        window.updateStats = updateStats;
        window.getGameData = () => gameData;
    </script>

</body>
</html>
